"01_–û—Å–Ω–æ–≤—ã_VPN_–∏_–∫–ª—é—á–µ–π.md": """
# üß™ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 1: –û—Å–Ω–æ–≤—ã VPN –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π

## –¶–µ–ª—å
–ü–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –æ—Å–Ω–æ–≤–∞–º–∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫–ª—é—á–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö VPN-–Ω–∞—Å—Ç—Ä–æ–µ–∫.

## –ó–∞–¥–∞–Ω–∏—è
1. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä—É SSH-–∫–ª—é—á–µ–π: `ssh-keygen -t ed25519`
2. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ TLS-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —Å –ø–æ–º–æ—â—å—é `openssl`:
   - –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á: `openssl genpkey -algorithm RSA -out key.pem`
   - –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç: `openssl req -new -x509 -key key.pem -out cert.pem -days 365`
3. –°–æ–∑–¥–∞–π—Ç–µ —Å—Ö–µ–º—É –º–æ–¥–µ–ª–∏ OSI –∏ –æ—Ç–º–µ—Ç—å—Ç–µ, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è VPN.
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `curl`, `nmap`, `tcpdump`.

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ù–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–π –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –≥–¥–µ –∂–∏–≤—ë—Ç VPN.
# üß™ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 2: OpenVPN-—Å–µ—Ä–≤–µ—Ä —Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏

## –¶–µ–ª—å
–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å OpenVPN-—Å–µ—Ä–≤–µ—Ä —Å TLS –∏ –∫–ª–∏–µ–Ω—Ç–æ–º –Ω–∞ Ubuntu.

## –ó–∞–¥–∞–Ω–∏—è
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `openvpn` –∏ `easy-rsa`.
2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ PKI –∏ —Å–æ–∑–¥–∞–π—Ç–µ:
   - CA
   - –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–µ—Ä–≤–µ—Ä–∞
   - –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `/etc/openvpn/server.conf`:
   - –ø–æ—Ä—Ç 1194 UDP, dev tun
   - tls-auth –∏ user/pass –∏–ª–∏ cert-only
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–Ω—Ñ–∏–≥.
5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ: `openvpn --config client.ovpn`

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –†–∞–±–æ—á–µ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ OpenVPN –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–æ–º –∏ –∫–ª–∏–µ–Ω—Ç–æ–º.
# üß™ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WireGuard Peer-to-Peer

## –¶–µ–ª—å
–°–æ–∑–¥–∞—Ç—å –∑–∞—â–∏—â—ë–Ω–Ω—ã–π VPN-–∫–∞–Ω–∞–ª –º–µ–∂–¥—É –¥–≤—É–º—è Linux-–º–∞—à–∏–Ω–∞–º–∏ —á–µ—Ä–µ–∑ WireGuard.

## –ó–∞–¥–∞–Ω–∏—è
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ WireGuard: `apt install wireguard`
2. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª—é—á–∏:
   - `wg genkey | tee private | wg pubkey > public`
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `wg0` –Ω–∞ –æ–±–æ–∏—Ö —É–∑–ª–∞—Ö:
   - –ù–∞–∑–Ω–∞—á—å—Ç–µ IP, –ø–æ—Ä—Ç, private key
   - –ü—Ä–æ–ø–∏—à–∏—Ç–µ peer (public key, allowed-ips)
4. –î–æ–±–∞–≤—å—Ç–µ `PostUp` –∏ `PostDown` –ø—Ä–∞–≤–∏–ª–∞ `iptables`
5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ: `ping`, `wg show`, `iperf3`

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ó–∞—â–∏—â—ë–Ω–Ω–æ–µ p2p-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É –¥–≤—É–º—è —É–∑–ª–∞–º–∏.
# üß™ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 4: L2TP/IPsec ‚Äî –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä VPN

## –¶–µ–ª—å
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å VPN-—Å–µ—Ä–≤–µ—Ä –Ω–∞ –±–∞–∑–µ L2TP/IPsec –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫ –Ω–µ–º—É –∫–ª–∏–µ–Ω—Ç–∞ (Windows –∏–ª–∏ Linux).

## –ó–∞–¥–∞–Ω–∏—è

### –°–µ—Ä–≤–µ—Ä:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `strongswan`, `xl2tpd`, `ppp` (Debian/Ubuntu).
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `ipsec.conf`:
   - IKEv1, PSK, ESP AES256-SHA1
3. –ü—Ä–æ–ø–∏—à–∏—Ç–µ shared key –≤ `ipsec.secrets`
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `xl2tpd.conf` –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ L2TP
5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `options.xl2tpd` (authentication, DNS, mtu)
6. –ü—Ä–æ–ø–∏—à–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ `/etc/ppp/chap-secrets`
7. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç—ã 500/4500/1701 + UDP

### –ö–ª–∏–µ–Ω—Ç:
1. Windows/macOS: –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ L2TP VPN —á–µ—Ä–µ–∑ GUI
2. Linux: —á–µ—Ä–µ–∑ `NetworkManager` –∏–ª–∏ `ipsec + xl2tpd`

## –ü—Ä–æ–≤–µ—Ä–∫–∞:
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
- –í—ã–¥–∞—á–∞ IP –∏–∑ –ø—É–ª–∞
- –ü–∏–Ω–≥ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Ö–æ—Å—Ç–∞–º–∏ –≤ LAN

## –†–µ–∑—É–ª—å—Ç–∞—Ç
–†–∞–±–æ—á–µ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –∫ VPN —á–µ—Ä–µ–∑ L2TP/IPsec.
# üß™ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 5: SSTP VPN —Å TLS

## –¶–µ–ª—å
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSTP VPN-—Å–µ—Ä–≤–µ—Ä, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç, –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —Å Windows.

## –ó–∞–¥–∞–Ω–∏—è

### –°–µ—Ä–≤–µ—Ä:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `sstp-server` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SoftEther VPN.
2. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:
   - —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π –∏–ª–∏ Let‚Äôs Encrypt
3. –ü—Ä–æ–ø–∏—à–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ IP-–ø—É–ª
4. –†–∞–∑—Ä–µ—à–∏—Ç–µ –≤—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ TCP 443
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –≤ `openssl s_client`

### –ö–ª–∏–µ–Ω—Ç:
1. Windows: —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ VPN-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, —É–∫–∞–∂–∏—Ç–µ SSTP –∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∫–æ—Ä–Ω–µ–≤—ã—Ö —Ü–µ–Ω—Ç—Ä–æ–≤

## –ü—Ä–æ–≤–µ—Ä–∫–∞:
- `ipconfig` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ IP —á–µ—Ä–µ–∑ VPN
- `route print` ‚Äî –º–∞—Ä—à—Ä—É—Ç —Ç–æ–ª—å–∫–æ –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ø–æ–¥—Å–µ—Ç—å
- `netstat -an | find "443"`

## –†–µ–∑—É–ª—å—Ç–∞—Ç
–ó–∞—â–∏—â—ë–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VPN —á–µ—Ä–µ–∑ TLS –ø–æ–≤–µ—Ä—Ö HTTPS.
# üß™ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 6: IPsec Site-to-Site

## –¶–µ–ª—å
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç—É–Ω–Ω–µ–ª—å –º–µ–∂–¥—É –¥–≤—É–º—è —Å–∞–π—Ç–∞–º–∏ —á–µ—Ä–µ–∑ IPsec IKEv2.

## –ó–∞–¥–∞–Ω–∏—è

### –£–∑–µ–ª A:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ strongSwan/libreswan
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `ipsec.conf` —Å —É–∫–∞–∑–∞–Ω–∏–µ–º:
   - left, right IP, subnets, PSK, ike/esp –ø—Ä–æ—Ç–æ–∫–æ–ª—ã
3. –ü—Ä–æ–ø–∏—à–∏—Ç–µ –∫–ª—é—á –≤ `ipsec.secrets`
4. –†–∞–∑—Ä–µ—à–∏—Ç–µ –≤—Ö–æ–¥—è—â–∏–π UDP 500 –∏ 4500

### –£–∑–µ–ª B:
1. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–∫ –Ω–∞ A
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ NAT –∏–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π IP –Ω–µ –º–µ—à–∞–µ—Ç (–µ—Å–ª–∏ –¥–∞ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ IKEv2 + dynamic)

### –ü—Ä–æ–≤–µ—Ä–∫–∞:
- `ipsec up <conn>`
- `ipsec statusall`
- `ping` –º–µ–∂–¥—É –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –ø–æ–¥—Å–µ—Ç—è–º–∏
- `tcpdump` –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö —Ç—É–Ω–Ω–µ–ª—è

## –†–µ–∑—É–ª—å—Ç–∞—Ç
–°—Ç–∞–±–∏–ª—å–Ω—ã–π –∑–∞—â–∏—â—ë–Ω–Ω—ã–π –∫–∞–Ω–∞–ª –º–µ–∂–¥—É –¥–≤—É–º—è —Å–∞–π—Ç–∞–º–∏.
# üß™ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 7: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å VPN

## –¶–µ–ª—å
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∑–∞—â–∏—Ç—É –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è VPN.

## –ó–∞–¥–∞–Ω–∏—è

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ OpenVPN (`status.log`, `verb 4`)
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `logrotate` ‚Äî —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ —Ä–∞–∑ –≤ –¥–µ–Ω—å
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `promtail` –∏–ª–∏ `filebeat` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–æ–≥–æ–≤ –≤ Loki/ELK

### –ó–∞—â–∏—Ç–∞:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Fail2Ban
2. –°–æ–∑–¥–∞–π—Ç–µ jail –¥–ª—è OpenVPN –∏–ª–∏ L2TP
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–Ω –ø–æ 3 –Ω–µ—É–¥–∞—á–Ω—ã–º –ø–æ–ø—ã—Ç–∫–∞–º –≤—Ö–æ–¥–∞
4. –î–æ–±–∞–≤—å—Ç–µ GeoIP-–±–ª–æ–∫–∏—Ä–æ–≤–∫—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Telegram bot + API
2. –û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ hook:
   - `client-connect` –¥–ª—è OpenVPN
   - `post-up` –¥–ª—è WireGuard

## –†–µ–∑—É–ª—å—Ç–∞—Ç
VPN-—Å–∏—Å—Ç–µ–º–∞, –∑–∞—â–∏—â—ë–Ω–Ω–∞—è –æ—Ç –∞—Ç–∞–∫, —Å –ª–æ–≥–∞–º–∏ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏.
